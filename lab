#include <stdio.h>
#include <stdlib.h>
int array[100], n;
void insert();
void insert(int, int);
void delete(int);
void display();
int main()
{
	int choice, num;
	n = 0;
	while(1)
	{
		printf("\n1.Insert element\n2.Delete element\n3.Display all elements\n4.Quit\n");
		printf("Enter choice:");
		scanf("%d", &choice);
		switch(choice)
		{
			case 1:
			printf("Enter element to be inserted:");
			scanf("%d", &num);
			insert(num, n);
			n++;
			break;
			case 2:
			printf("Enter element to be deleted:");
			scanf("%d", &num);
			delete(num);
			break;
			case 3:
			display();
			break;
			case 4:
			exit(0);
			default:
			printf("Invalid choice\n");
		}
	}
	return 0;
}
void insert(int num, int loc)
{
	int parentnode;
	while(loc > 0)
	{
		parentnode = (loc - 1) / 2;
		if(num <= array[parentnode])
		{
			array[loc] = num;
			return;
		}
		array[loc] = array[parentnode];
		loc = parentnode;
	}
	array[0] = num;
}
void delete(int num)
{
	int left, right, i, temp, parentnode;
	for(i = 0; i < num; i++)
	{
		if(num == array[i])
		break;
	}
	if(num != array[i])
	{
		printf("%d not found in heap list\n", num);
		return;
	}
	array[i] = array[n - 1];
	n = n - 1;
	parentnode = (i - 1) / 2;
	if(array[i] > array[parentnode])
	{
		insert(array[i], i);
		return;
	}
	left = 2 * i + 1;
	right = 2 * i + 2;
	while(right < n)
	{
		if(array[i] >= array[left] && array[i] >= right)
		return;
		if(array[right] <= array[left])
		{
			temp = array[i];
			array[i] = array[left];
			array[left] = temp;
			i = left;
		}
		else
		{
			temp = array[i];
			array[i] = array[right];
			array[right] = temp;
			i = right;
		}
		left = 2 * i + 1;
		right = 2 * i + 2;
	}
	if(left == n - 1 && array[i])
	{
		temp = array[i];
		array[i] = array[left];
		array[left] = temp;
	}
}
void display()
{
	int i;
	if(n == 0)
	{
		printf("Heap is empty\n");
		return;
	}
	for(i = 0; i < n; i++)
	printf("%d", array[i]);
	printf("\n");
}
